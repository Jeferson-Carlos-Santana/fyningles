{% load static %}
{% csrf_token %}
<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover">
    <meta charset="utf-8">
    <title>chat</title>
    <link rel="stylesheet" href="{% static 'chat/css/style.css' %}">
    <link rel="stylesheet" href="{% static 'chat/css/chat.css' %}">
    <link rel="stylesheet" href="{% static 'chat/css/btn.css' %}">
    <link rel="stylesheet" href="{% static 'chat/css/others.css' %}">    
</head>
<body data-lesson-id="{{ lesson_id|default:'' }}" data-username="{{ username|escapejs }}">

  <div class="layout">
    <nav class="sidebar">
      <div class="sidebar-inner">
        <div class="sidebar-close">
          âœ•
        </div>
        <div class="bar-1">          
          <div class="infor user-session"><img src="{% static 'chat/img/user-y.png' %}" alt="Menu" width="15"> OlÃ¡, {{ request.user.username }}!</div>
          <div class="info-lesson">
          <div class="infor"><img src="{% static 'chat/img/flag-v.png' %}" alt="Menu" width="15"> Pontos acumulados: <span class="text-warning-light" id="total-points">0</span></div>
          <div class="infor"><img src="{% static 'chat/img/flag.png' %}" alt="Menu" width="15"> Pontos que faltam: <span class="text-warning-light" id="points-faltam">0</span></div>
          <div class="infor"><img src="{% static 'chat/img/flag-y.png' %}" alt="Menu" width="15"> Pontos feitos: <span class="text-warning-light" id="points-feitos">0</span></div>
          </div>
          <ul class="menu">  
            {% if request.user.is_superuser %}
            <li><a href="/admin/"><img src="{% static 'chat/img/lock.png' %}" alt="Menu" width="15"> AdministraÃ§Ã£o</a></li>
            {% endif %}          
            <li><a href="/dashboard/"><img src="{% static 'chat/img/dashboard.png' %}" alt="Menu" width="15"> Dashboard</a></li>  
            {% if request.user.is_superuser %}                        
            <li><a href="/dictionary/"><img src="{% static 'chat/img/book.png' %}" alt="Menu" width="15"> DicionÃ¡rio</a></li> 
            {% endif %}                  
          </ul>
        </div>
        <input type="text" class="lesson-search" placeholder="ğŸ” Buscar liÃ§Ã£o">
        <div class="bar-2">                        
          <ul class="menu lessons">                            
            <li><a href="/chat/1/">ğŸ“‹ Usando verbos</a></li>
            <li><a href="/chat/2/">ğŸ“‹ ExpressÃµes populares</a></li>
            <li><a href="/chat/3/">ğŸ“‹ Utilidades diÃ¡rias</a></li>            
          </ul>
        </div>
      </div>
    </nav>

    <main class="content">
      <div class="content-inner">
        
        <div class="tittle-cont">
            <button class="menu-toggle" aria-label="Abrir menu">
              <img src="{% static 'chat/img/sidebar.png' %}" alt="Menu">
            </button> 
            <span>Chat : {{ lesson_title }}</span>    
            <form method="post" action="/admin/logout/" class="logout-form">
              {% csrf_token %}
              <button class="btn-sair" type="submit" aria-label="Sair">
                <img src="{% static 'chat/img/log-out.png' %}" alt="Sair" width="41">
              </button>
            </form>
        </div>
        <div class="painel-master">
            <div class="play-m"> 
            <button class="play-madeira-velha" id="btn-start" title="Iniciar liÃ§Ã£o." disabled></button>
            </div>
            <button id="btnAutoSkip" class="auto-off" title="AvanÃ§a para prÃ³xima frase quando fecha o microfone.">SKIP<br>OFF</button>
            <button id="btnAutoMic" class="auto-off" title="Ativar o microfone automÃ¡ticamente.">MIC<br>OFF</button> 
            <div class="tempontos">
             <div id="timer-aula" style="
              font-weight: bold;
              color: #ffd480;
            ">
             â±ï¸ 00:00
            </div>
            <div><img src="{% static 'chat/img/point.png' %}" alt="Sair" width="20"> <span class="text-warning-light" id="points-andamento">0</span></div>
            </div>
        </div>

        <div class="chat-area">
          {% for line in lines %}
          <div class="chat-message {{ line.role }} base"
            data-id="{{ line.id }}"
            data-auto="{{ line.auto|yesno:'1,0' }}"
            data-end="{{ line.end|yesno:'1,0' }}"
            data-expected="{{ line.expected_en|default:'' }}"
            style="display:none;">
            {{ line.content_pt|safe }}
          </div>
          {% endfor %}
        </div> 
        
        <div class="inline-input">            
            <input type="text" id="mensagem" placeholder="Digite sua resposta." oncopy="return false" onpaste="return false" oncut="return false" autocomplete="off" />           
            <button id="btnEnviar" class="btn-madeira-velha" onclick="enviarMensagem()"><img src="{% static 'chat/img/send.png' %}" alt="Sair" width="30"></button>
            <button class="btn-madeira-velha" id="btn-mic" onclick="toggleMic()">ğŸ¤</button>    
        </div>

        <div class="footer-cont">
          <!-- {% comment %} <button class="theme-toggle" aria-label="Trocar tema">ğŸŒ™ </button> {% endcomment %} -->
          <i><strong>Â© 2026 - JPM-development - All rights reserved - Engineering e Technology</strong></i>                        
        </div>
        <div class="cell-footer">

        </div>
      </div>
    </main>
  </div>

<!-- MODAL NIVEL -->
<div id="nivel-modal" class="nivel-modal" style="display:none;">
  <div class="nivel-box">
    <button class="nivel-close" aria-label="Fechar">Ã—</button>
    <h3>Qual nÃ­vel vocÃª se encaixa?</h3>
    <label><input type="radio" name="nivel" value="1"> RepetiÃ§Ã£o bÃ¡sica <span class="text-warning-middle">(repete menos vezes a frase)</span>.</label>
    <label><input type="radio" name="nivel" value="2"> RepetiÃ§Ã£o intermediÃ¡ria.</label>
    <label><input type="radio" name="nivel" value="3"> RepetiÃ§Ã£o intensiva <span class="text-warning-middle">(repete a frase mais vezes)</span>.</label>
    <label>Essas repetiÃ§Ãµes serÃ£o distribuÃ­das ao longo do tempo, de modo a garantir maior eficÃ¡cia no processo de aprendizagem.</label>
    <label>Essas opÃ§Ãµes estÃ£o relacionadas Ã  facilidade individual de aprendizagem. Caso tenha dÃºvida, recomenda-se optar pela opÃ§Ã£o intermediÃ¡ria. A escolha poderÃ¡ ser realizada apenas uma Ãºnica vez.</label>
    <label>A pergunta a ser considerada Ã©: <i class="text-warning-middle">Eu aprendo frases com facilidade?</i></label>
    <button id="btn-salvar-nivel">Confirmar</button>
  </div>
</div>

<script src="{% static 'chat/js/script.js' %}"></script> 
<script src="{% static 'chat/js/chat.js' %}"></script>
</body>
</html> 